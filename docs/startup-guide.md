# 开机加速功能使用指南

CleanC提供了强大的开机加速功能，通过管理Windows启动项，您可以显著减少系统启动时间，提升电脑性能。

## 功能介绍

开机加速模块允许您：

1. **一目了然地查看所有启动项**：显示所有设置为开机自动启动的程序
2. **一键启用/禁用启动项**：通过简单的开关即可控制程序是否开机启动
3. **直观的图标识别**：自动识别常见程序，并显示对应的品牌图标

## 使用方法

1. 在CleanC应用左侧菜单中点击"开机加速"
2. 系统将自动扫描并显示所有当前的开机启动项
3. 对于不需要的启动项，直接点击开关将其关闭
4. 随时可以再次打开启动项，方便灵活管理

## 注意事项

- **管理员权限**：某些系统启动项可能需要管理员权限才能修改
- **系统核心服务**：建议不要禁用Windows系统核心服务的启动项
- **图标和名称**：程序图标和名称是自动识别的，可能与实际略有差异

## 常见问题解答

### 禁用启动项后为什么没有生效？

某些程序可能通过多种方式设置自启动，我们建议：
- 重启电脑检查是否真的已禁用
- 检查程序本身的设置，有些程序有独立的自启动设置
- 尝试使用管理员权限运行CleanC应用

### 为什么有些启动项无法禁用？

- 系统保护的启动项需要更高权限才能禁用
- 某些安全软件可能阻止修改启动项
- 尝试右键点击CleanC应用并选择"以管理员身份运行"

### 禁用某些启动项会影响系统吗？

- 大多数第三方应用的启动项可以安全禁用
- 建议保留杀毒软件、安全程序等重要启动项
- 如果不确定某个启动项的作用，可以搜索该程序名称获取更多信息

## 开发者测试功能

我们提供了完整的测试工具，验证开机加速功能是否正常工作：

```bash
# 运行单元测试
npm run test-startup

# 运行集成测试
npm run test-startup-integration
```

测试将验证以下功能：
- 使用Registry API添加和删除启动项
- 使用PowerShell命令添加和删除启动项
- 模拟实际应用场景的集成测试

运行测试需要管理员权限，因为测试过程会实际操作系统注册表。测试会自动清理所有添加的测试数据，不会对系统造成永久影响。

## 技术实现

开机加速功能主要通过管理Windows注册表中的启动项来实现，具体控制以下位置：

1. `HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run`
2. `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run`
3. 用户启动文件夹 (Startup folder)

具有双重实现机制，确保高兼容性：
- 优先使用Windows Registry API直接操作注册表
- 备选使用PowerShell命令进行操作，提高成功率 